{"version":3,"sources":["../../src/query/shadow-hosts.js"],"names":["queryShadowHosts","filter","node","shadowRoot","NodeFilter","FILTER_ACCEPT","FILTER_SKIP","acceptNode","context","element","label","resolveDocument","defaultToDocument","_document","walker","createTreeWalker","SHOW_ELEMENT","list","push","concat","nextNode","currentNode"],"mappings":";;;;;;;;;;;;;;;;;;oBAgBwBA,gB;;;;;;;;;;;;AAZxB;AACA,MAAMC,SAAS,SAATA,MAAS,CAASC,IAAT,EAAe;AAC5B,QAAIA,KAAKC,UAAT,EAAqB;AACnB,aAAOC,WAAWC,aAAlB;AACD;;AAED,WAAOD,WAAWE,WAAlB;AACD,GAND;AAOA;AACA;AACAL,SAAOM,UAAP,GAAoBN,MAApB;;AAEe,WAASD,gBAAT,GAA4C;AAAA,mFAAJ,EAAI;AAAA,QAAhBQ,OAAgB,QAAhBA,OAAgB;;AACzD,QAAMC,UAAU,gCAAiB;AAC/BC,aAAO,oBADwB;AAE/BC,uBAAiB,IAFc;AAG/BC,yBAAmB,IAHY;AAI/BJ;AAJ+B,KAAjB,CAAhB;;AAOA,QAAMK,YAAY,2BAAYL,OAAZ,CAAlB;AACA;AACA,QAAMM,SAASD,UAAUE,gBAAV;AACb;AACAN,WAFa;AAGb;AACAL,eAAWY,YAJE;AAKb;AACAf,UANa;AAOb;AACA,SARa,CAAf;;AAWA,QAAIgB,OAAO,EAAX;;AAEA,QAAIR,QAAQN,UAAZ,EAAwB;AACtB;AACAc,WAAKC,IAAL,CAAUT,OAAV;AACAQ,aAAOA,KAAKE,MAAL,CAAYnB,iBAAiB;AAClCQ,iBAASC,QAAQN;AADiB,OAAjB,CAAZ,CAAP;AAGD;;AAED,WAAOW,OAAOM,QAAP,EAAP,EAA0B;AACxBH,WAAKC,IAAL,CAAUJ,OAAOO,WAAjB;AACAJ,aAAOA,KAAKE,MAAL,CAAYnB,iBAAiB;AAClCQ,iBAASM,OAAOO,WAAP,CAAmBlB;AADM,OAAjB,CAAZ,CAAP;AAGD;;AAED,WAAOc,IAAP;AACD","file":"shadow-hosts.js","sourcesContent":["\r\nimport contextToElement from '../util/context-to-element';\r\nimport getDocument from '../util/get-document';\r\n\r\n// see https://developer.mozilla.org/en-US/docs/Web/API/NodeFilter\r\nconst filter = function(node) {\r\n  if (node.shadowRoot) {\r\n    return NodeFilter.FILTER_ACCEPT;\r\n  }\r\n\r\n  return NodeFilter.FILTER_SKIP;\r\n};\r\n// IE requires a function, Browsers require {acceptNode: function}\r\n// see http://www.bennadel.com/blog/2607-finding-html-comment-nodes-in-the-dom-using-treewalker.htm\r\nfilter.acceptNode = filter;\r\n\r\nexport default function queryShadowHosts({ context } = {}) {\r\n  const element = contextToElement({\r\n    label: 'query/shadow-hosts',\r\n    resolveDocument: true,\r\n    defaultToDocument: true,\r\n    context,\r\n  });\r\n\r\n  const _document = getDocument(context);\r\n  // see https://developer.mozilla.org/en-US/docs/Web/API/Document/createTreeWalker\r\n  const walker = _document.createTreeWalker(\r\n    // root element to start search in\r\n    element,\r\n    // element type filter\r\n    NodeFilter.SHOW_ELEMENT,\r\n    // custom NodeFilter filter\r\n    filter,\r\n    // deprecated, but IE requires it\r\n    false\r\n  );\r\n\r\n  let list = [];\r\n\r\n  if (element.shadowRoot) {\r\n    // TreeWalker does not run the filter on the context element\r\n    list.push(element);\r\n    list = list.concat(queryShadowHosts({\r\n      context: element.shadowRoot,\r\n    }));\r\n  }\r\n\r\n  while (walker.nextNode()) {\r\n    list.push(walker.currentNode);\r\n    list = list.concat(queryShadowHosts({\r\n      context: walker.currentNode.shadowRoot,\r\n    }));\r\n  }\r\n\r\n  return list;\r\n}\r\n"]}
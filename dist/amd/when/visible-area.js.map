{"version":3,"sources":["../../src/when/visible-area.js"],"names":["context","callback","area","TypeError","element","label","raf","evaluate","disengage","cancelAnimationFrame","predicate","checkPredicate","requestAnimationFrame"],"mappings":";;;;;;;;;;;;;;;;;;;oBAUe,YAAyC;AAAA,mFAAJ,EAAI;AAAA,QAA/BA,OAA+B,QAA/BA,OAA+B;AAAA,QAAtBC,QAAsB,QAAtBA,QAAsB;AAAA,QAAZC,IAAY,QAAZA,IAAY;;AACtD,QAAI,OAAOD,QAAP,KAAoB,UAAxB,EAAoC;AAClC,YAAM,IAAIE,SAAJ,CAAc,8DAAd,CAAN;AACD;;AAED,QAAI,OAAOD,IAAP,KAAgB,QAApB,EAA8B;AAC5BA,aAAO,CAAP;AACD;;AAED,QAAME,UAAU,gCAAiB;AAC/BC,aAAO,mBADwB;AAE/BL;AAF+B,KAAjB,CAAhB;;AAKA,QAAIM,YAAJ;AACA,QAAIC,WAAW,IAAf;AACA,QAAMC,YAAY,SAAZA,SAAY,GAAW;AAC3BF,aAAOG,qBAAqBH,GAArB,CAAP;AACD,KAFD;;AAIA,QAAMI,YAAY,SAAZA,SAAY,GAAW;AAC3B,aAAO,CAAC,uBAAUN,OAAV,CAAD,IAAuB,2BAAYA,OAAZ,IAAuBF,IAA9C,IAAsDD,SAASG,OAAT,MAAsB,KAAnF;AACD,KAFD;;AAIA,QAAMO,iBAAiB,SAAjBA,cAAiB,GAAW;AAChC,UAAID,WAAJ,EAAiB;AACfH;AACA;AACD;;AAEDC;AACD,KAPD;;AASAD,eAAW,oBAAW;AACpBD,YAAMM,sBAAsBD,cAAtB,CAAN;AACD,KAFD;;AAIAJ;AACA,WAAO,EAAEC,oBAAF,EAAP;AACD,G","file":"visible-area.js","sourcesContent":["\r\n/*\r\n  execute a callback once an element became fully visible in the viewport\r\n*/\r\n\r\nimport '../prototype/window.requestanimationframe';\r\nimport isVisible from '../is/visible';\r\nimport visibleArea from '../util/visible-area';\r\nimport contextToElement from '../util/context-to-element';\r\n\r\nexport default function({context, callback, area} = {}) {\r\n  if (typeof callback !== 'function') {\r\n    throw new TypeError('when/visible-area requires options.callback to be a function');\r\n  }\r\n\r\n  if (typeof area !== 'number') {\r\n    area = 1;\r\n  }\r\n\r\n  const element = contextToElement({\r\n    label: 'when/visible-area',\r\n    context,\r\n  });\r\n\r\n  let raf;\r\n  let evaluate = null;\r\n  const disengage = function() {\r\n    raf && cancelAnimationFrame(raf);\r\n  };\r\n\r\n  const predicate = function() {\r\n    return !isVisible(element) || visibleArea(element) < area || callback(element) === false;\r\n  };\r\n\r\n  const checkPredicate = function() {\r\n    if (predicate()) {\r\n      evaluate();\r\n      return;\r\n    }\r\n\r\n    disengage();\r\n  };\r\n\r\n  evaluate = function() {\r\n    raf = requestAnimationFrame(checkPredicate);\r\n  };\r\n\r\n  evaluate();\r\n  return { disengage };\r\n}\r\n"]}
{"version":3,"sources":["../../src/is/only-tabbable.js"],"names":["isVisible","contextToElement","getFrameElement","tabindexValue","platform","isOnlyTabbableRules","context","except","onlyFocusableBrowsingContext","visible","element","label","resolveDocument","is","GECKO","TRIDENT","EDGE","frameElement","nodeName","toLowerCase","tabindex","ownerSVGElement","focus","hasAttribute","isOnlyTabbable","rules"],"mappings":";AACA,OAAOA,SAAP,MAAsB,WAAtB;AACA,OAAOC,gBAAP,MAA6B,4BAA7B;AACA,OAAOC,eAAP,MAA4B,2BAA5B;AACA,OAAOC,aAAP,MAA0B,wBAA1B;AACA,OAAOC,QAAP,MAAqB,kBAArB;;AAEA,SAASC,mBAAT,GAMQ;AAAA,iFAAJ,EAAI;AAAA,MALNC,OAKM,QALNA,OAKM;AAAA,yBAJNC,MAIM;AAAA,MAJNA,MAIM,+BAJG;AACPC,kCAA8B,KADvB;AAEPC,aAAS;AAFF,GAIH;;AACN,MAAMC,UAAUT,iBAAiB;AAC/BU,WAAO,kBADwB;AAE/BC,qBAAiB,IAFc;AAG/BN;AAH+B,GAAjB,CAAhB;;AAMA,MAAI,CAACC,OAAOE,OAAR,IAAmB,CAACT,UAAUU,OAAV,CAAxB,EAA4C;AAC1C,WAAO,KAAP;AACD;;AAED,MAAI,CAACH,OAAOC,4BAAR,KAAyCJ,SAASS,EAAT,CAAYC,KAAZ,IAAqBV,SAASS,EAAT,CAAYE,OAAjC,IAA4CX,SAASS,EAAT,CAAYG,IAAjG,CAAJ,EAA4G;AAC1G,QAAMC,eAAef,gBAAgBQ,OAAhB,CAArB;AACA,QAAIO,YAAJ,EAAkB;AAChB,UAAId,cAAcc,YAAd,IAA8B,CAAlC,EAAqC;AACnC;AACA;AACA,eAAO,KAAP;AACD;AACF;AACF;;AAED,MAAMC,WAAWR,QAAQQ,QAAR,CAAiBC,WAAjB,EAAjB;AACA,MAAMC,WAAWjB,cAAcO,OAAd,CAAjB;;AAEA,MAAIQ,aAAa,OAAb,IAAwBd,SAASS,EAAT,CAAYC,KAAxC,EAA+C;AAC7C;AACA,WAAOM,aAAa,IAAb,IAAqBA,YAAY,CAAxC;AACD;;AAED;AACA;AACA;AACA,MAAIhB,SAASS,EAAT,CAAYC,KAAZ,IAAqBJ,QAAQW,eAA7B,IAAgD,CAACX,QAAQY,KAA7D,EAAoE;AAClE,QAAIJ,aAAa,GAAb,IAAoBR,QAAQa,YAAR,CAAqB,YAArB,CAAxB,EAA4D;AAC1D;AACA,UAAInB,SAASS,EAAT,CAAYC,KAAhB,EAAuB;AACrB,eAAO,IAAP;AACD;AACF;AACF;;AAED,SAAO,KAAP;AACD;;AAED;AACAT,oBAAoBE,MAApB,GAA6B,YAAsB;AAAA,MAAbA,MAAa,uEAAJ,EAAI;;AACjD,MAAMiB,iBAAiB,SAAjBA,cAAiB,CAASlB,OAAT,EAAkB;AACvC,WAAOD,oBAAoB;AACzBC,sBADyB;AAEzBC;AAFyB,KAApB,CAAP;AAID,GALD;;AAOAiB,iBAAeC,KAAf,GAAuBpB,mBAAvB;AACA,SAAOmB,cAAP;AACD,CAVD;;AAYA;AACA,IAAMA,iBAAiBnB,oBAAoBE,MAApB,CAA2B,EAA3B,CAAvB;AACA,eAAeiB,cAAf","file":"only-tabbable.js","sourcesContent":["\r\nimport isVisible from './visible';\r\nimport contextToElement from '../util/context-to-element';\r\nimport getFrameElement from '../util/get-frame-element';\r\nimport tabindexValue from '../util/tabindex-value';\r\nimport platform from '../util/platform';\r\n\r\nfunction isOnlyTabbableRules({\r\n  context,\r\n  except = {\r\n    onlyFocusableBrowsingContext: false,\r\n    visible: false,\r\n  },\r\n} = {}) {\r\n  const element = contextToElement({\r\n    label: 'is/only-tabbable',\r\n    resolveDocument: true,\r\n    context,\r\n  });\r\n\r\n  if (!except.visible && !isVisible(element)) {\r\n    return false;\r\n  }\r\n\r\n  if (!except.onlyFocusableBrowsingContext && (platform.is.GECKO || platform.is.TRIDENT || platform.is.EDGE)) {\r\n    const frameElement = getFrameElement(element);\r\n    if (frameElement) {\r\n      if (tabindexValue(frameElement) < 0) {\r\n        // iframe[tabindex=\"-1\"] and object[tabindex=\"-1\"] inherit the\r\n        // tabbable demotion onto elements of their browsing contexts\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n\r\n  const nodeName = element.nodeName.toLowerCase();\r\n  const tabindex = tabindexValue(element);\r\n\r\n  if (nodeName === 'label' && platform.is.GECKO) {\r\n    // Firefox cannot focus, but tab to: label[tabindex=0]\r\n    return tabindex !== null && tabindex >= 0;\r\n  }\r\n\r\n  // SVG Elements were keyboard focusable but not script focusable before Firefox 51.\r\n  // Firefox 51 added the focus management DOM API (.focus and .blur) to SVGElement,\r\n  // see https://bugzilla.mozilla.org/show_bug.cgi?id=778654\r\n  if (platform.is.GECKO && element.ownerSVGElement && !element.focus) {\r\n    if (nodeName === 'a' && element.hasAttribute('xlink:href')) {\r\n      // any focusable child of <svg> cannot be focused, but tabbed to\r\n      if (platform.is.GECKO) {\r\n        return true;\r\n      }\r\n    }\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\n// bind exceptions to an iterator callback\r\nisOnlyTabbableRules.except = function(except = {}) {\r\n  const isOnlyTabbable = function(context) {\r\n    return isOnlyTabbableRules({\r\n      context,\r\n      except,\r\n    });\r\n  };\r\n\r\n  isOnlyTabbable.rules = isOnlyTabbableRules;\r\n  return isOnlyTabbable;\r\n};\r\n\r\n// provide isOnlyTabbable(context) as default iterator callback\r\nconst isOnlyTabbable = isOnlyTabbableRules.except({});\r\nexport default isOnlyTabbable;\r\n"]}
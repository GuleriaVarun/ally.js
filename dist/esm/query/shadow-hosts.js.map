{"version":3,"sources":["../../src/query/shadow-hosts.js"],"names":["contextToElement","getDocument","filter","node","shadowRoot","NodeFilter","FILTER_ACCEPT","FILTER_SKIP","acceptNode","queryShadowHosts","context","element","label","resolveDocument","defaultToDocument","_document","walker","createTreeWalker","SHOW_ELEMENT","list","push","concat","nextNode","currentNode"],"mappings":";AACA,OAAOA,gBAAP,MAA6B,4BAA7B;AACA,OAAOC,WAAP,MAAwB,sBAAxB;;AAEA;AACA,IAAMC,SAAS,SAATA,MAAS,CAASC,IAAT,EAAe;AAC5B,MAAIA,KAAKC,UAAT,EAAqB;AACnB,WAAOC,WAAWC,aAAlB;AACD;;AAED,SAAOD,WAAWE,WAAlB;AACD,CAND;AAOA;AACA;AACAL,OAAOM,UAAP,GAAoBN,MAApB;;AAEA,eAAe,SAASO,gBAAT,GAA4C;AAAA,iFAAJ,EAAI;AAAA,MAAhBC,OAAgB,QAAhBA,OAAgB;;AACzD,MAAMC,UAAUX,iBAAiB;AAC/BY,WAAO,oBADwB;AAE/BC,qBAAiB,IAFc;AAG/BC,uBAAmB,IAHY;AAI/BJ;AAJ+B,GAAjB,CAAhB;;AAOA,MAAMK,YAAYd,YAAYS,OAAZ,CAAlB;AACA;AACA,MAAMM,SAASD,UAAUE,gBAAV;AACb;AACAN,SAFa;AAGb;AACAN,aAAWa,YAJE;AAKb;AACAhB,QANa;AAOb;AACA,OARa,CAAf;;AAWA,MAAIiB,OAAO,EAAX;;AAEA,MAAIR,QAAQP,UAAZ,EAAwB;AACtB;AACAe,SAAKC,IAAL,CAAUT,OAAV;AACAQ,WAAOA,KAAKE,MAAL,CAAYZ,iBAAiB;AAClCC,eAASC,QAAQP;AADiB,KAAjB,CAAZ,CAAP;AAGD;;AAED,SAAOY,OAAOM,QAAP,EAAP,EAA0B;AACxBH,SAAKC,IAAL,CAAUJ,OAAOO,WAAjB;AACAJ,WAAOA,KAAKE,MAAL,CAAYZ,iBAAiB;AAClCC,eAASM,OAAOO,WAAP,CAAmBnB;AADM,KAAjB,CAAZ,CAAP;AAGD;;AAED,SAAOe,IAAP;AACD","file":"shadow-hosts.js","sourcesContent":["\r\nimport contextToElement from '../util/context-to-element';\r\nimport getDocument from '../util/get-document';\r\n\r\n// see https://developer.mozilla.org/en-US/docs/Web/API/NodeFilter\r\nconst filter = function(node) {\r\n  if (node.shadowRoot) {\r\n    return NodeFilter.FILTER_ACCEPT;\r\n  }\r\n\r\n  return NodeFilter.FILTER_SKIP;\r\n};\r\n// IE requires a function, Browsers require {acceptNode: function}\r\n// see http://www.bennadel.com/blog/2607-finding-html-comment-nodes-in-the-dom-using-treewalker.htm\r\nfilter.acceptNode = filter;\r\n\r\nexport default function queryShadowHosts({ context } = {}) {\r\n  const element = contextToElement({\r\n    label: 'query/shadow-hosts',\r\n    resolveDocument: true,\r\n    defaultToDocument: true,\r\n    context,\r\n  });\r\n\r\n  const _document = getDocument(context);\r\n  // see https://developer.mozilla.org/en-US/docs/Web/API/Document/createTreeWalker\r\n  const walker = _document.createTreeWalker(\r\n    // root element to start search in\r\n    element,\r\n    // element type filter\r\n    NodeFilter.SHOW_ELEMENT,\r\n    // custom NodeFilter filter\r\n    filter,\r\n    // deprecated, but IE requires it\r\n    false\r\n  );\r\n\r\n  let list = [];\r\n\r\n  if (element.shadowRoot) {\r\n    // TreeWalker does not run the filter on the context element\r\n    list.push(element);\r\n    list = list.concat(queryShadowHosts({\r\n      context: element.shadowRoot,\r\n    }));\r\n  }\r\n\r\n  while (walker.nextNode()) {\r\n    list.push(walker.currentNode);\r\n    list = list.concat(queryShadowHosts({\r\n      context: walker.currentNode.shadowRoot,\r\n    }));\r\n  }\r\n\r\n  return list;\r\n}\r\n"]}